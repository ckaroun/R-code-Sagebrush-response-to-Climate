{
    "contents" : "\n#MAKE LINEAR MODEL AND GRAPH IT\n\n#Change plot parameter to have 1 plot per screen\npar(mfrow=c(1,1))\n\n\n#pdf(\"linear models.pdf\")\n\n#make lists of input data sources to be iterated over. first index is 3200m; second is 3500m; third index is 3800m \nPSource<-c(\"4k PRISM White Mountain 3200m\",\"4k PRISM White Mountain 3500m\",\"4k PRISM White Mountain 3800m\")\nTSource<-c(\"4k PRISM White Mountain 3200m\",\"4k PRISM White Mountain 3500m\",\"4k PRISM White Mountain 3800m\")\nCSource<-c(\"3200m radial growth\",\"3500m radial growth\",\"3800m radial growth\")\n#define row indexes of only overlapping years between Cdf and Wdf\nfor (i in 1:3){\n  # subset the data to only the relevant years and data source. \n  p.row.i<-Precipdf[,2]==PSource[i] & Precipdf[,3]%in% chrons[chrons[,2]==CSource[i],3]\n  c.row.i<-chrons[,2]==CSource[i]& chrons[,3] %in% Precipdf[p.row.i,3]#doesn't need & Wdf[,3]%in% Cdf[,3] because years overlap with themselves! #example name: \"3200m radial growth                                                                            \"\n  # example name \"PRISM White Mountain 3200m\"\n  t.row.i<-Tempdf[,2]==TSource[i] & Tempdf[,3]%in% chrons[chrons[,2]==CSource[i],3]#example name: \"Crooked Creek Weather Station Filled Missing Values (3200m)\"\n  #follow kalman filter analysis of dendrochonology in biometrics and make output(y) and explanatory variables(Zt) mean of 0 and unit variance of 1\n  Tempdf[t.row.i,1]<- (Tempdf[t.row.i,1]-mean(Tempdf[t.row.i,1]))/sd(Tempdf[t.row.i,1]) ### \n  Precipdf[p.row.i,1]<- (Precipdf[p.row.i,1]-mean(Precipdf[p.row.i,1]))/sd(Precipdf[p.row.i,1])\n  \n  \n  fit<-lm(chrons[c.row.i,1]~Precipdf[p.row.i,1]*Tempdf[t.row.i,1])\n  \n  #browser()\n  \n  if(summary(fit)$coeff[2,4]<.12){\n  plot(Precipdf[p.row.i,1], chrons[c.row.i,1], main=paste(\"Precipitation's effect on Ring Growth\",substr(PSource[i],24,30)), xlab= \"Precipitation(mm)\", ylab=\"Ring Growth (mm)\")\n  abline(coef=fit$coefficients[c(1,2)],col=\"black\")\n  text(min(Precipdf[p.row.i,1]+20),fit$coeff[1]+.2,paste(\"p=\",round(summary(fit)$coeff[2,4],3)),cex=.8) \n  }\n  \n  if(summary(fit)$coeff[3,4]<.12){\n  plot(Tempdf[p.row.i,1], chrons[c.row.i,1], main=paste(\"Temperature's effect on Ring Growth\",substr(PSource[i],24,30)), xlab= \"Temperature(C)\", ylab=\"Ring Growth (mm)\")\n  abline(coef=fit$coefficients[c(1,3)],col=\"black\")\n  text(min(Tempdf[p.row.i,1]+.2),fit$coeff[1]+.2,paste(\"p=\",round(summary(fit)$coeff[3,4],3)),cex=.8) \n  }\n  \n  if(i==1){M3200m<-fit\n  }else if(i==2){M3500m<-fit\n  }else{M3800m<-fit}\n}\n#dev.off()\n  #   #plot(fit)\n  #   #need this package for nonlinearity test\n  #   # require(car)\n  #   # crPlots(fit)\n  #   #ceresPlots(fit)\n  #   vcov(fit)\n  #   fitted(fit)\n  #   influence(fit)\nsummary(M3200m)\nsummary(M3500m)\nsummary(M3800m)\n\n#LOOK AT INTERACTION\n### [plot mean effect]\n# compute the slope for Ring Growth on Precip while holding the moderator variable Temp at constant valuesrange of Temp which we will hold \n# to do this find the total coefficient for Precip in the model equation for each value of Temp\n# this is the equation Y=b0+b1*P+b2*T+b3*TP\nsummary(Tempdf[c.row.i,1])\nat.temp<- seq(-.2,1.75,.25)\nslopes<- M3200m$coef[2]+ M3200m$coef[4]*at.temp\nplot(at.temp,slopes,type=\"l\",lty=1, xlab=\"Level of Temp(C)\",ylab= \"Marginal Effect of Precip (total coefficient)\")\nabline(h=0,col=\"grey\")\n\n### [plot mean effect]\n# compute the slope for Ring Growth on Precip while holding the moderator variable Temp at constant valuesrange of Temp which we will hold \n# to do this find the total coefficient for Precip in the model equation for each value of Temp\n# this is the equation Y=b0+b1*P+b2*T+b3*TP\nsummary(Precipdf[c.row.i,1])\nat.precip<- seq(0,700,50)\nslopes<- M3200m$coef[3]+ M3200m$coef[4]*at.precip\nplot(at.precip,slopes,type=\"l\",lty=1, xlab=\"Level of Precip(mm)\",ylab= \"Marginal Effect of Temp (total coefficient)\")\nabline(h=0,col=\"grey\")\n\n\n\n\n\n\n#pdf(\"Multiple Linear regression residual plots\")\n# plot(M3200m)\n# \n# plot(M3500m)\n# \n# plot(M3800m)\n#dev.off()\n\n#pdf(\"univariate correlations\")\nplot(Precipdf[p.row.i,1],chrons[c.row.i,1],type=\"p\", ylab=\"Ring Growth\", xlab=\"Precipitation\")\npoints(Precipdf[p.row.i,1],predict(M3200m),col=\"red\")\nlegend(\"topleft\",legend=\"lm prediction\", lwd=1, col=\"red\")\nabline(M3200m)\n#best fit\nbf1<-lm(chrons[c.row.i,1]~Precipdf[p.row.i,1])\n#abline(bf1)\nsummary(bf1)\n\nplot(Tempdf[t.row.i,1],chrons[c.row.i,1], ylab=\"Ring Growth\", xlab=\"Temperature\")\npoints(Tempdf[p.row.i,1],predict(M3200m),col=\"red\")\nlegend(\"topleft\",legend=\"lm prediction\", lwd=1, col=\"red\")\n\n#bf2<-lm(chrons[c.row.i,1]~Precipdf[p.row.i,1])\nabline(bf2)\nsummary(bf2)\nabline(M3800m)\n\n#dev.off()",
    "created" : 1461092512841.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1376286337",
    "id" : "54A6C937",
    "lastKnownWriteTime" : 1461358441,
    "path" : "C:/Users/Tower/Desktop/Sagebrush's response to Climate/R-code Sagebrush response to Climate/Sagebrush Response to Climate R Studio Project/code/LinearModel Maybe PRE MESS-UP.R",
    "project_path" : "code/LinearModel Maybe PRE MESS-UP.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}